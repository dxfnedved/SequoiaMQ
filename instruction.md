# SequoiaMQ 量化交易系统说明文档

## 1. 项目概述

SequoiaMQ 是一个基于 Python 的量化交易分析系统，集成了多种交易策略和技术分析工具，提供图形化界面进行股票分析和策略回测。

### 1.1 核心功能

- 股票数据实时获取和缓存
- 多因子分析策略（Alpha101、Alpha191）
- 技术指标分析（RSRS、海龟交易法则等）
- 图形化股票走势展示
- 自选股管理和批量分析
- 买卖信号实时提示
- 分析结果导出功能

### 1.2 目标和宗旨

- 为投资者提供专业的量化分析工具
- 集成多种成熟的交易策略
- 提供直观的可视化界面
- 支持策略的快速验证和优化
- 保证数据的实时性和准确性

## 2. 技术栈

### 2.1 核心框架和库

- **GUI框架**: PySide6
- **数据处理**: Pandas, NumPy
- **技术分析**: TA-Lib
- **数据可视化**: Matplotlib, mplfinance
- **数据获取**: Akshare
- **日志管理**: Loguru

### 2.2 依赖包版本

```
akshare>=1.15.0
numpy>=1.20.0
pandas>=1.3.0
scikit-learn>=0.24.0
schedule>=1.1.0
TA-Lib>=0.4.0
PyYAML>=5.4.0
requests>=2.26.0
tqdm>=4.65.0
colorama>=0.4.0
PySide6>=6.6.1
shiboken6>=6.6.1
pypinyin>=0.49.0
matplotlib>=3.7.1
mplfinance
plotly>=5.6.0
loguru>=0.7.2
```

## 3. 项目结构

```
SequoiaMQ/
├── strategy/                # 策略模块
│   ├── __init__.py
│   ├── base.py            # 策略基类
│   ├── RSRS.py            # RSRS策略
│   ├── alpha_factors101.py # Alpha101因子
│   ├── alpha_factors191.py # Alpha191因子
│   ├── enter.py           # 入场策略
│   ├── turtle_trade.py    # 海龟交易策略
│   ├── low_atr.py         # 低波动策略
│   ├── low_backtrace_increase.py # 低回撤增长策略
│   ├── keep_increasing.py  # 持续上涨策略
│   └── backtrace_ma250.py # 回踩年线策略
├── cache/                  # 数据缓存目录
├── data/                   # 数据存储目录
│   ├── watchlist.json     # 自选股列表
│   └── strategy_settings.json # 策略设置
├── logs/                   # 日志目录
├── main.py                # 主程序入口
├── main_window.py         # 主窗口
├── stock_chart.py         # 股票图表
├── stock_search.py        # 股票搜索
├── stock_cache.py         # 股票缓存
├── watchlist_widget.py    # 自选股组件
├── strategy_selector_widget.py # 策略选择组件
├── work_flow.py           # 工作流程
├── data_fetcher.py        # 数据获取
├── settings.py            # 配置管理
├── logger_manager.py      # 日志管理
├── analysis_dialog.py     # 分析结果对话框
├── requirements.txt       # 依赖包列表
├── config.yaml           # 配置文件
└── Dockerfile            # Docker配置文件
```

## 4. 界面功能

### 4.1 主界面布局

主界面采用左右分栏设计：
- 左侧面板：
  - 股票搜索组件（支持代码、名称、拼音搜索）
  - 自选股列表（实时更新行情）
- 右侧标签页：
  - K线图标签页
  - 策略选择标签页

### 4.2 股票搜索

- 支持多种搜索方式：
  - 股票代码
  - 股票名称
  - 拼音全拼
  - 拼音首字母
- 实时过滤显示
- 下拉框选择
- 自动完成功能

### 4.3 自选股管理

- 自选股列表显示：
  - 股票代码和名称
  - 实时价格
  - 涨跌幅
  - 换手率
  - 操作按钮
- 15秒自动更新行情
- 支持批量操作：
  - 批量分析
  - 批量删除
- 单个股票操作：
  - 分析
  - 删除
  - 双击查看详情
- 自动保存自选股列表

### 4.4 策略管理

- 策略选择界面：
  - 策略列表显示
  - 策略说明
  - 全选/清空功能
  - 保存设置
- 支持的策略：
  - RSRS策略
  - Alpha101策略
  - Alpha191策略
  - 海龟交易策略
  - 入场策略
  - 低波动策略
  - 低回撤增长策略
  - 持续上涨策略
  - 回踩年线策略
- 策略设置持久化

### 4.5 图表显示

- K线图显示：
  - 日K线
  - 成交量
  - 技术指标
- 买卖信号标记：
  - 不同策略使用不同颜色
  - 信号说明
  - 信号强度

## 5. 数据管理

### 5.1 数据获取

- 实时行情数据：
  - 15秒自动更新
  - 批量获取
  - 异常处理
- 历史数据：
  - 按需获取
  - 本地缓存
  - 定期更新

### 5.2 数据存储

- 本地缓存：
  - 股票列表缓存
  - 历史数据缓存
  - 自动清理过期数据
- 配置文件：
  - 自选股列表
  - 策略设置
  - 用户偏好

## 6. 策略系统

### 6.1 策略框架

- 策略基类：
  - 统一接口
  - 标准化输出
  - 异常处理
- 策略组合：
  - 多策略并行
  - 信号合成
  - 权重配置

### 6.2 内置策略

1. **RSRS策略**
   - 阻力支撑相对强度
   - 标准分择时
   - 支撑位计算

2. **Alpha101策略**
   - 多维度因子体系：
     * 动量类因子：
       - 12个月动量
       - 6个月动量
       - 3个月动量
       - 指数加权动量（120日半衰期）
     * 反转类因子：
       - 短期反转（5日）
       - 中期反转（20日）
       - 长期反转（60日）
     * 波动率类因子：
       - 250日波动率
       - 120日波动率
       - 60日波动率
       - 指数加权波动率（40日半衰期）
     * 成交量类因子：
       - 成交量动量
       - 成交量波动率
       - VWAP比率
       - 相对成交量
     * 相关性类因子：
       - 收益率-成交量相关性
       - 价格区间-成交量相关性
     * 技术指标类因子：
       - RSI
       - MACD
       - 布林带宽度
       - ATR
   - 因子处理：
     * 标准化处理
     * 等权重合成
     * 综合得分计算
   - 信号生成：
     * 基于综合得分
     * 结合价格趋势
     * 动态阈值调整

3. **Alpha191策略**
   - 基于国泰君安金工团队研究
   - 多维度因子体系：
     * Beta因子：沪深300指数回归（250日窗口，60日半衰期）
     * 动量因子：RSTR（120日半衰期）
     * 规模因子：LNCAP（总市值对数）
     * 盈利类因子：
       - EPIBS（一致预期每股收益）
       - ETOP（12个月净利润/市值）
       - CETOP（现金收益比）
     * 波动率因子：
       - DASTD（40日半衰期波动率）
       - CMRA（累积范围波动率）
       - HSIGMA（特异波动率）
     * 成长因子：
       - SGRO（5年营收增长率）
       - EGRO（5年净利润增长率）
       - EGIB（3年预期增长率）
       - EGIB_S（1年预期增长率）
     * 价值因子：BTOP（账面市值比）
     * 杠杆因子：
       - MLEV（市场杠杆）
       - DTOA（资产负债率）
       - BLEV（账面杠杆）
     * 流动性因子：
       - STOM（月换手率）
       - STOQ（季换手率）
       - STOA（年换手率）
   - 因子处理：
     * 正交标准化
     * 指数加权计算
     * 综合得分生成
   - 信号生成：
     * 基于综合得分
     * 结合价格趋势
     * 考虑交易成本

4. **海龟交易策略**
   - 趋势跟踪
   - 波动率计算
   - 仓位管理

5. **入场策略**
   - 突破信号
   - 成交量确认
   - 均线支撑

6. **低波动策略**
   - ATR指标
   - 均线系统
   - 放量确认

7. **低回撤增长策略**
   - 回撤控制
   - 增长速度
   - 趋势确认

8. **持续上涨策略**
   - 上涨天数
   - 涨幅统计
   - 回撤控制

9. **回踩年线策略**
   - MA250支撑
   - RSI超卖
   - 放量回踩

## 7. 使用说明

### 7.1 启动方式

```bash
# GUI模式
python main.py --gui

# 命令行模式
python main.py
```

### 7.2 基本操作流程

1. 搜索股票：
   - 在搜索框输入代码/名称/拼音
   - 从下拉列表选择股票
   - 自动添加到自选股

2. 管理自选股：
   - 查看实时行情
   - 批量分析选中股票
   - 删除不需要的股票

3. 配置策略：
   - 切换到策略选择标签页
   - 选择需要的策略
   - 保存策略设置

4. 分析股票：
   - 选择单个或多个股票
   - 点击分析按钮
   - 查看分析结果

5. 查看详情：
   - 双击股票查看K线图
   - 查看策略信号
   - 导出分析结果

## 8. 注意事项

1. 数据源限制
   - 实时数据刷新频率限制
   - 历史数据获取限制
   - API调用频率限制

2. 系统性能
   - 批量分析时注意数量
   - 定期清理缓存数据
   - 避免频繁切换股票

3. 策略使用
   - 策略信号仅供参考
   - 建议组合多个策略
   - 注意风险控制

4. 免责声明
   - 策略回测结果仅供参考
   - 实盘交易需自行承担风险
   - 数据仅供参考，不构成投资建议
``` 